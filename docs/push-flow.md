# 推送流程说明

本文档用于说明 TradSig 中「实盘更新推送」的整体流程，帮助理解推送从产生到用户点击后的完整路径。

---

## 推送触发条件

当系统检测到以下情况之一时，会触发推送流程：

- 生成新的交易记录
- 已有记录发生状态更新
- 扫描模块确认存在需要通知用户的变化

推送的目的在于 **提醒用户有新的记录可查看**，而非传递完整业务数据。

---

## 推送生成流程

整体流程如下：

1. 扫描与记录生成模块产生更新结果
2. 系统根据记录所属页面（page_key）确定目标用户
3. 按用户与设备维度进行去重判断
4. 构造推送内容并发送至 APNs

推送过程在服务器侧完成，客户端仅作为接收端。

---

## 推送内容说明（示例）

推送 payload 中包含用于承接页面的关键信息，例如：

- page_key：用于标识对应的页面或品种
- rid：记录的唯一标识
- time：记录生成或更新时间

示例结构（脱敏）：

```json
{
  "aps": {
    "alert": {
      "title": "交易记录更新",
      "body": "铁矿 i2405 记录已更新"
    },
    "sound": "default"
  },
  "page_key": "idce",
  "rid": 12345,
  "time": "2025-12-18 10:00:00"
}
